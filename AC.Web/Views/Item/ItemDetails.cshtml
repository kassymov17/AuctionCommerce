@model ItemDetailsModel
@using AC.Core.Domain.Catalog
@using AC.Web.Models.Catalog;

@{
    Layout = "~/Views/Shared/_ColumnsOne.cshtml";
    
}
@section Breadcrumb
{
    @* TODO breadcrumbs *@    
}

<script type="text/javascript">
    $(document).ready(function () {
        var endDate = "@String.Format("{0:yyyy/M/d}", Model.EndDate).Replace(".", "/")";
        $("#timeLeft").countdown(endDate, function(event) {
            $(this).html(event.strftime('%D дней %H:%M:%S'));
        });
    });
</script>

<div class="page product-details-page">
    <div class="page-body">
        @using (Html.BeginRouteForm("Item", new { itemId = Model.Id}, FormMethod.Post, new { id = "product-details-form" }))
        {
            <div itemscope itemtype="http://schema.org/Product" data-productid="@Model.Id">
                <div class="product-essential">
                    @Html.Partial("_ItemDetailsPictures", Model)
                    <div class="overview">
                        <div class="product-name">
                            <h1 itemprop="name">
                                @Model.Name
                            </h1>
                        </div>
                        @if (!String.IsNullOrEmpty(Model.ShortDescription))
                        {
                            <div class="short-description">
                                @Html.Raw(Model.ShortDescription)
                            </div>
                        }
                        @{
                            if (Model.ItemType == ItemType.AuctionItem)
                            {
                                <p>Тип товара: <strong>Аукцион</strong></p>
                                if (@Model.Bids.Any())
                                {
                                    <p>Лидер: <strong>@Model.Bids.OrderByDescending(b => b.Amount).FirstOrDefault().User.Email</strong></p>
                                }
                                <p>Времени до окончания: <strong id="timeLeft"></strong></p>
                                <p>Ставок: @Model.Bids.Count (<a href="#bids">Показать</a>)</p>
                                <p>Текущая цена: <strong>@Model.ItemPrice.Price тенге</strong></p>
                                <p>Владелец лота: <strong>@Model.User.Username</strong></p>
                                @Html.Partial("_PlaceBid", Model.PlaceBid)
                            }
                            else
                            {
                                <p>Цена</p>
                                <h1>@Model.ItemPrice.Price Тенге</h1>
                                @Html.Partial("_AddToCart", Model.AddToCart)
                            }
                        }
                        
                    </div>
                    @if (!String.IsNullOrEmpty(Model.FullDescription))
                    {
                        <div class="full-description" itemprop="description">
                            @Html.Raw(Model.FullDescription)
                        </div>
                    }
                </div>
                <div class="product-collateral" id="bids">
                    @Html.Partial("_ItemBids", Model.Bids)
                </div>
            </div>
        }
    </div>
</div>